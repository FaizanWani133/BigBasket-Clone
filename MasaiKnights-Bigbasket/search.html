<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- <link rel="stylesheet" href="./../products.css"> -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans:wght@100&display=swap"
      rel="stylesheet"
    />
    <title>Fruits & Vegetables</title>
    <link rel="stylesheet" href="./productData/products.css" />
    <script
      src="https://kit.fontawesome.com/b678f324bd.js"
      crossorigin="anonymous"
    ></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script>
      $(function () {
        $('#includedContent').load('./../../navbar.html');
      });
    </script>
  </head>

  <body>
    <div id="includedContent"></div>
    <section class="main-products">
      <div class="filters-section">
        <div class="brand-filter">
          <h4 class="filter-title">Brand</h4>

          <div class="filter-checkbox">
            <input class="checkbox" id="brand-filter1" type="checkbox" /><span
              >Fresho</span
            >
          </div>
          <div class="filter-checkbox">
            <input class="checkbox" id="brand-filter2" type="checkbox" /><span
              >BB Combo</span
            >
          </div>
          <div class="filter-checkbox">
            <input
              class="checkbox"
              id="brand-filter3"
              type="checkbox"
              style="display: none"
            />
          </div>
          <div class="filter-checkbox">
            <input
              class="checkbox"
              id="brand-filter4"
              type="checkbox"
              style="display: none"
            />
          </div>
          <div class="filter-checkbox">
            <input
              class="checkbox"
              id="brand-filter5"
              type="checkbox"
              style="display: none"
            />
          </div>
          <div class="filter-checkbox">
            <input
              class="checkbox"
              id="brand-filter6"
              type="checkbox"
              style="display: none"
            />
          </div>
          <div class="filter-checkbox">
            <input
              class="checkbox"
              id="brand-filter7"
              type="checkbox"
              style="display: none"
            />
          </div>
          <div class="filter-checkbox">
            <input
              class="checkbox"
              id="brand-filter8"
              type="checkbox"
              style="display: none"
            />
          </div>
          <!-- <div class="filter-checkbox">
            <input type="checkbox" /><span>BB Popular</span>
          </div>
          <div class="filter-checkbox">
            <input type="checkbox" /><span>BB Royal</span>
          </div>
          <div class="filter-checkbox">
            <input type="checkbox" /><span>Fortune</span>
          </div>
          <div class="filter-checkbox">
            <input type="checkbox" /><span>Tata Salt</span>
          </div>
          <div class="filter-checkbox">
            <input type="checkbox" /><span>Shree Neelkamal</span>
          </div> -->
        </div>

        <div class="price-filter">
          <h4 class="filter-title">Price</h4>
          <div class="filter-checkbox">
            <input class="checkbox" id="brand-filter9" type="checkbox" /><span
              >Less than Rs 20
            </span>
          </div>
          <div class="filter-checkbox">
            <input class="checkbox" id="brand-filter10" type="checkbox" /><span
              >Rs 21 to Rs 50
            </span>
          </div>
          <div class="filter-checkbox">
            <input class="checkbox" id="brand-filter11" type="checkbox" /><span
              >Rs 51 to Rs 100
            </span>
          </div>
          <div class="filter-checkbox">
            <input class="checkbox" id="brand-filter12" type="checkbox" /><span
              >Rs 101 to Rs 200
            </span>
          </div>
          <div class="filter-checkbox">
            <input class="checkbox" id="brand-filter13" type="checkbox" /><span
              >More than Rs 201
            </span>
          </div>
        </div>
        <div class="discount-filter">
          <h4 class="filter-title">Discount</h4>
          <div class="filter-checkbox">
            <input class="checkbox" id="brand-filter14" type="checkbox" /><span
              >Upto 5%
            </span>
          </div>
          <div class="filter-checkbox">
            <input class="checkbox" id="brand-filter15" type="checkbox" /><span
              >5% - 10%
            </span>
          </div>
          <div class="filter-checkbox">
            <input class="checkbox" id="brand-filter16" type="checkbox" /><span
              >10% - 15%
            </span>
          </div>
          <div class="filter-checkbox">
            <input class="checkbox" id="brand-filter17" type="checkbox" /><span
              >More than 15%</span
            >
          </div>
        </div>
      </div>

      <div class="products-container">
        <div class="products-heading">
          <h2 id="title">All Products</h2>
        </div>
        <div class="sort-bar">
          <select id="sort-bar">
            <option value="">Popularity</option>
            <option value="">Price - Low to High</option>
            <option value="">Price - High to Low</option>
            <option value="">Alphabetical</option>
            <option value="">% Off - High to Low</option>
          </select>
        </div>
        <div class="allproducts-border">
          <i class="fa-solid fa-truck"> <span>ALL PRODUCTS</span> </i>
        </div>
        <div class="products-cards"></div>
      </div>
    </section>
  </body>
</html>
<script src="./productData/pro.js"></script>
<script>
  var allProductArr = [];
  allProducts.beautyArr.forEach((element) => {
    allProductArr.push(element);
  });
  allProducts.beveragesArr.forEach((element) => {
    allProductArr.push(element);
  });
  allProducts.cleaningArr.forEach((element) => {
    allProductArr.push(element);
  });
  allProducts.dairyArr.forEach((element) => {
    allProductArr.push(element);
  });
  allProducts.eggsArr.forEach((element) => {
    allProductArr.push(element);
  });
  allProducts.foodgrainsArr.forEach((element) => {
    allProductArr.push(element);
  });
  allProducts.kitchenArr.forEach((element) => {
    allProductArr.push(element);
  });
  allProducts.snacksArr.forEach((element) => {
    allProductArr.push(element);
  });
  allProducts.vegetableArr.forEach((element) => {
    allProductArr.push(element);
  });

  //Get Data from local storage
  // search
  var searchTarget = localStorage.getItem('searchTarget');
  localStorage.removeItem('searchTarget');

  // offers in navbar
  var showAllOffers = localStorage.getItem('ShowAllOffers');
  localStorage.removeItem('ShowAllOffers');

  // Discount divs on the main page
  var itemPriceLessThen30 = localStorage.getItem('showItemsPriceLessThen30');
  localStorage.removeItem('showItemsPriceLessThen30');
  var DealsOfTheWeekImg1 = localStorage.getItem('DealsOfTheWeekImg1');
  localStorage.removeItem('DealsOfTheWeekImg1');
  var BigPackBiggerDiscount = localStorage.getItem('BigPackBiggerDiscount');
  localStorage.removeItem('BigPackBiggerDiscount');
  var CombosYouCantMiss = localStorage.getItem('CombosYouCantMiss');
  localStorage.removeItem('CombosYouCantMiss');

  if (searchTarget != null) {
    allProductArr = allProductArr.filter((value) => {
      var name = value.name.toLowerCase();
      var brand = value.brand.toLowerCase();
      var quantity = value.Quantity.toLowerCase();
      if (
        name.includes(searchTarget.toLowerCase()) ||
        brand.includes(searchTarget.toLowerCase()) ||
        quantity.includes(searchTarget.toLowerCase())
      )
        return value;
    });
  } else if (showAllOffers != null) {
    allProductArr = allProductArr.filter((value) => {
      var price = value.price;
      var stPrice = value.strikedOdprice;
      if (stPrice > price) return value;
    });
  } else if (itemPriceLessThen30 != null) {
    allProductArr = allProductArr.filter((value) => {
      if (value.price <= 30) return value;
    });
  } else if (BigPackBiggerDiscount != null) {
    allProductArr = allProductArr.filter((value) => {
      var discount =
        ((+value.strikedOdprice - +value.price) / +value.strikedOdprice) * 100;
      if (discount >= 30) return value;
    });
  } else if (DealsOfTheWeekImg1 != null) {
    allProductArr = allProductArr.filter((value) => {
      var discount =
        ((+value.strikedOdprice - +value.price) / +value.strikedOdprice) * 100;
      if (discount >= 30 && value.price < 100) return value;
    });
  } else if (CombosYouCantMiss != null) {
    allProductArr = allProductArr.filter((value) => {
      var discount =
        ((+value.strikedOdprice - +value.price) / +value.strikedOdprice) * 100;
      if (value.price > 500) return value;
    });
  }

  var checkboxArr = document.querySelectorAll('.checkbox');

  for (var i = 0; i < checkboxArr.length; i++) {
    checkboxArr[i].addEventListener('click', function () {
      var newArr = [];

      if (brandFilter1.checked === true) {
        newArr = allProductArr.filter(function (elem) {
          return elem.brand == 'MAGGI';
        });
        //   displayProducts(newArr);
      }
      if (brandFilter2.checked === true) {
        var tempArr = allProductArr.filter(function (elem) {
          return elem.brand == 'Fresho';
        });
        for (var i = 0; i < tempArr.length; i++) {
          newArr.push(tempArr[i]);
        }
        //   displayProducts(newArr);
      }
      if (brandFilter3.checked === true) {
        var tempArr = allProductArr.filter(function (elem) {
          return elem.brand == 'Lays';
        });
        for (var i = 0; i < tempArr.length; i++) {
          newArr.push(tempArr[i]);
        }
        //   displayProducts(newArr);
      }
      if (brandFilter4.checked === true) {
        var tempArr = allProductArr.filter(function (elem) {
          return elem.brand == 'Britannia';
        });
        for (var i = 0; i < tempArr.length; i++) {
          newArr.push(tempArr[i]);
        }
        //   displayProducts(newArr);
      }
      if (brandFilter5.checked === true) {
        var tempArr = allProductArr.filter(function (elem) {
          return elem.brand == 'Shree Neelkamal';
        });
        for (var i = 0; i < tempArr.length; i++) {
          newArr.push(tempArr[i]);
        }
        //   displayProducts(newArr);
      }
      if (brandFilter6.checked === true) {
        var tempArr = allProductArr.filter(function (elem) {
          return elem.brand == 'BB Popular';
        });
        for (var i = 0; i < tempArr.length; i++) {
          newArr.push(tempArr[i]);
        }
        //   displayProducts(newArr);
      }
      if (brandFilter7.checked === true) {
        var tempArr = allProductArr.filter(function (elem) {
          return elem.Quantity.includes('can');
        });
        for (var i = 0; i < tempArr.length; i++) {
          newArr.push(tempArr[i]);
        }
        //   displayProducts(newArr);
      }
      if (brandFilter8.checked === true) {
        var tempArr = allProductArr.filter(function (elem) {
          return elem.Quantity.includes('tin');
        });
        for (var i = 0; i < tempArr.length; i++) {
          newArr.push(tempArr[i]);
        }
        //   displayProducts(newArr);
      }
      if (brandFilter9.checked === true) {
        var tempArr = allProductArr.filter(function (elem) {
          return parseInt(elem.price) <= 20;
        });
        for (var i = 0; i < tempArr.length; i++) {
          newArr.push(tempArr[i]);
        }
        //   displayProducts(newArr);
      }
      if (brandFilter10.checked === true) {
        var tempArr = allProductArr.filter(function (elem) {
          return parseInt(elem.price) >= 20 && parseInt(elem.price) <= 50;
        });
        for (var i = 0; i < tempArr.length; i++) {
          newArr.push(tempArr[i]);
        }
        //   displayProducts(newArr);
      }
      if (brandFilter11.checked === true) {
        var tempArr = allProductArr.filter(function (elem) {
          return parseInt(elem.price) > 50 && parseInt(elem.price) <= 100;
        });
        for (var i = 0; i < tempArr.length; i++) {
          newArr.push(tempArr[i]);
        }
        //   displayProducts(newArr);
      }
      if (brandFilter12.checked === true) {
        var tempArr = allProductArr.filter(function (elem) {
          return parseInt(elem.price) > 100 && parseInt(elem.price) <= 200;
        });
        for (var i = 0; i < tempArr.length; i++) {
          newArr.push(tempArr[i]);
        }
        //   displayProducts(newArr);
      }
      if (brandFilter13.checked === true) {
        var tempArr = allProductArr.filter(function (elem) {
          return parseInt(elem.price) > 200;
        });
        for (var i = 0; i < tempArr.length; i++) {
          newArr.push(tempArr[i]);
        }
        //   displayProducts(newArr);
      }
      if (brandFilter14.checked === true) {
        var tempArr = allProductArr.filter(function (elem) {
          return (
            ((+elem.strikedOdprice - +elem.price) / +elem.strikedOdprice) *
              100 <=
            5
          );
        });
        for (var i = 0; i < tempArr.length; i++) {
          newArr.push(tempArr[i]);
        }
        //   displayProducts(newArr);
      }
      if (brandFilter15.checked === true) {
        var tempArr = allProductArr.filter(function (elem) {
          return (
            ((+elem.strikedOdprice - +elem.price) / +elem.strikedOdprice) *
              100 >
              5 &&
            ((+elem.strikedOdprice - +elem.price) / +elem.strikedOdprice) *
              100 <=
              10
          );
        });
        for (var i = 0; i < tempArr.length; i++) {
          newArr.push(tempArr[i]);
        }
        //   displayProducts(newArr);
      }
      if (brandFilter16.checked === true) {
        var tempArr = allProductArr.filter(function (elem) {
          return (
            ((+elem.strikedOdprice - +elem.price) / +elem.strikedOdprice) *
              100 >
              10 &&
            ((+elem.strikedOdprice - +elem.price) / +elem.strikedOdprice) *
              100 <=
              15
          );
        });
        for (var i = 0; i < tempArr.length; i++) {
          newArr.push(tempArr[i]);
        }
        //   displayProducts(newArr);
      }
      if (brandFilter17.checked === true) {
        var tempArr = allProductArr.filter(function (elem) {
          return (
            ((+elem.strikedOdprice - +elem.price) / +elem.strikedOdprice) *
              100 >
            15
          );
        });
        for (var i = 0; i < tempArr.length; i++) {
          newArr.push(tempArr[i]);
        }
        //   displayProducts(newArr);
      }
      if (
        brandFilter1.checked == false &&
        brandFilter2.checked == false &&
        brandFilter3.checked == false &&
        brandFilter4.checked == false &&
        brandFilter5.checked == false &&
        brandFilter6.checked == false &&
        brandFilter7.checked == false &&
        brandFilter8.checked == false &&
        brandFilter9.checked == false &&
        brandFilter10.checked == false &&
        brandFilter11.checked == false &&
        brandFilter12.checked == false &&
        brandFilter13.checked == false &&
        brandFilter14.checked == false &&
        brandFilter15.checked == false &&
        brandFilter16.checked == false &&
        brandFilter17.checked == false
      ) {
        document.querySelector('#title').innerText +=
          ' (' + allProductArr.length + ')';
        displayProducts(allProductArr);
      } else {
        document.querySelector('#title').innerText +=
          ' (' + allProductArr.length + ')';
        displayProducts(newArr);
      }
    });
  }
  document.querySelector('#title').innerText +=
    ' (' + allProductArr.length + ')';
  displayProducts(allProductArr);
</script>
